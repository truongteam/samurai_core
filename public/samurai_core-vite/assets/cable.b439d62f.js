import{c as ln}from"./_commonjsHelpers.042e6b4d.js";import{g as fn}from"./global.4c9502f9.js";var bt={},pn={get exports(){return bt},set exports(ot){bt=ot}};(function(ot,dn){(function(mt,X){ot.exports=X()})(ln,function(){return(()=>{var mt={392:function(C,k,I){var $,B;(function(){(function(){(function(){var A=[].slice;this.ActionCable={INTERNAL:{message_types:{welcome:"welcome",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},WebSocket:window.WebSocket,logger:window.console,createConsumer:function(p){var c;return p==null&&(p=(c=this.getConfig("url"))!=null?c:this.INTERNAL.default_mount_path),new m.Consumer(this.createWebSocketURL(p))},getConfig:function(p){var c;return(c=document.head.querySelector("meta[name='action-cable-"+p+"']"))!=null?c.getAttribute("content"):void 0},createWebSocketURL:function(p){var c;return p&&!/^wss?:/i.test(p)?((c=document.createElement("a")).href=p,c.href=c.href,c.protocol=c.protocol.replace("http","ws"),c.href):p},startDebugging:function(){return this.debugging=!0},stopDebugging:function(){return this.debugging=null},log:function(){var p,c;if(p=1<=arguments.length?A.call(arguments,0):[],this.debugging)return p.push(Date.now()),(c=this.logger).log.apply(c,["[ActionCable]"].concat(A.call(p)))}}}).call(this)}).call(this);var m=this.ActionCable;(function(){(function(){m.ConnectionMonitor=function(){var A,p,c;function s(a){var v,g;this.connection=a,this.visibilityDidChange=(v=this.visibilityDidChange,g=this,function(){return v.apply(g,arguments)}),this.reconnectAttempts=0}return s.pollInterval={min:3,max:30},s.staleThreshold=6,s.prototype.start=function(){if(!this.isRunning())return this.startedAt=p(),delete this.stoppedAt,this.startPolling(),document.addEventListener("visibilitychange",this.visibilityDidChange),m.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms")},s.prototype.stop=function(){if(this.isRunning())return this.stoppedAt=p(),this.stopPolling(),document.removeEventListener("visibilitychange",this.visibilityDidChange),m.log("ConnectionMonitor stopped")},s.prototype.isRunning=function(){return this.startedAt!=null&&this.stoppedAt==null},s.prototype.recordPing=function(){return this.pingedAt=p()},s.prototype.recordConnect=function(){return this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,m.log("ConnectionMonitor recorded connect")},s.prototype.recordDisconnect=function(){return this.disconnectedAt=p(),m.log("ConnectionMonitor recorded disconnect")},s.prototype.startPolling=function(){return this.stopPolling(),this.poll()},s.prototype.stopPolling=function(){return clearTimeout(this.pollTimeout)},s.prototype.poll=function(){return this.pollTimeout=setTimeout((a=this,function(){return a.reconnectIfStale(),a.poll()}),this.getPollInterval());var a},s.prototype.getPollInterval=function(){var a,v,g,f;return g=(f=this.constructor.pollInterval).min,v=f.max,a=5*Math.log(this.reconnectAttempts+1),Math.round(1e3*A(a,g,v))},s.prototype.reconnectIfStale=function(){if(this.connectionIsStale())return m.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+c(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?m.log("ConnectionMonitor skipping reopening recent disconnect"):(m.log("ConnectionMonitor reopening"),this.connection.reopen())},s.prototype.connectionIsStale=function(){var a;return c((a=this.pingedAt)!=null?a:this.startedAt)>this.constructor.staleThreshold},s.prototype.disconnectedRecently=function(){return this.disconnectedAt&&c(this.disconnectedAt)<this.constructor.staleThreshold},s.prototype.visibilityDidChange=function(){if(document.visibilityState==="visible")return setTimeout((a=this,function(){if(a.connectionIsStale()||!a.connection.isOpen())return m.log("ConnectionMonitor reopening stale connection on visibilitychange. visbilityState = "+document.visibilityState),a.connection.reopen()}),200);var a},p=function(){return new Date().getTime()},c=function(a){return(p()-a)/1e3},A=function(a,v,g){return Math.max(v,Math.min(g,a))},s}()}).call(this),function(){var A,p,c,s,a,v=[].slice,g=[].indexOf||function(f){for(var h=0,P=this.length;h<P;h++)if(h in this&&this[h]===f)return h;return-1};s=m.INTERNAL,p=s.message_types,c=s.protocols,a=2<=c.length?v.call(c,0,A=c.length-1):(A=0,[]),c[A++],m.Connection=function(){function f(h){var P,W;this.consumer=h,this.open=(P=this.open,W=this,function(){return P.apply(W,arguments)}),this.subscriptions=this.consumer.subscriptions,this.monitor=new m.ConnectionMonitor(this),this.disconnected=!0}return f.reopenDelay=500,f.prototype.send=function(h){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(h)),!0)},f.prototype.open=function(){return this.isActive()?(m.log("Attempted to open WebSocket, but existing socket is "+this.getState()),!1):(m.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+c),this.webSocket!=null&&this.uninstallEventHandlers(),this.webSocket=new m.WebSocket(this.consumer.url,c),this.installEventHandlers(),this.monitor.start(),!0)},f.prototype.close=function(h){var P;if((h??{allowReconnect:!0}).allowReconnect||this.monitor.stop(),this.isActive())return(P=this.webSocket)!=null?P.close():void 0},f.prototype.reopen=function(){var h;if(m.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(P){return h=P,m.log("Failed to reopen WebSocket",h)}finally{m.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},f.prototype.getProtocol=function(){var h;return(h=this.webSocket)!=null?h.protocol:void 0},f.prototype.isOpen=function(){return this.isState("open")},f.prototype.isActive=function(){return this.isState("open","connecting")},f.prototype.isProtocolSupported=function(){var h;return h=this.getProtocol(),g.call(a,h)>=0},f.prototype.isState=function(){var h,P;return P=1<=arguments.length?v.call(arguments,0):[],h=this.getState(),g.call(P,h)>=0},f.prototype.getState=function(){var h,P;for(P in WebSocket)if(WebSocket[P]===((h=this.webSocket)!=null?h.readyState:void 0))return P.toLowerCase();return null},f.prototype.installEventHandlers=function(){var h,P;for(h in this.events)P=this.events[h].bind(this),this.webSocket["on"+h]=P},f.prototype.uninstallEventHandlers=function(){var h;for(h in this.events)this.webSocket["on"+h]=function(){}},f.prototype.events={message:function(h){var P,W,U;if(this.isProtocolSupported())switch(P=(U=JSON.parse(h.data)).identifier,W=U.message,U.type){case p.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case p.ping:return this.monitor.recordPing();case p.confirmation:return this.subscriptions.notify(P,"connected");case p.rejection:return this.subscriptions.reject(P);default:return this.subscriptions.notify(P,"received",W)}},open:function(){if(m.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return m.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(h){if(m.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){return m.log("WebSocket onerror event")}},f}()}.call(this),function(){var A=[].slice;m.Subscriptions=function(){function p(c){this.consumer=c,this.subscriptions=[]}return p.prototype.create=function(c,s){var a,v,g;return v=typeof(a=c)=="object"?a:{channel:a},g=new m.Subscription(this.consumer,v,s),this.add(g)},p.prototype.add=function(c){return this.subscriptions.push(c),this.consumer.ensureActiveConnection(),this.notify(c,"initialized"),this.sendCommand(c,"subscribe"),c},p.prototype.remove=function(c){return this.forget(c),this.findAll(c.identifier).length||this.sendCommand(c,"unsubscribe"),c},p.prototype.reject=function(c){var s,a,v,g,f;for(g=[],s=0,a=(v=this.findAll(c)).length;s<a;s++)f=v[s],this.forget(f),this.notify(f,"rejected"),g.push(f);return g},p.prototype.forget=function(c){var s;return this.subscriptions=function(){var a,v,g,f;for(f=[],a=0,v=(g=this.subscriptions).length;a<v;a++)(s=g[a])!==c&&f.push(s);return f}.call(this),c},p.prototype.findAll=function(c){var s,a,v,g,f;for(g=[],s=0,a=(v=this.subscriptions).length;s<a;s++)(f=v[s]).identifier===c&&g.push(f);return g},p.prototype.reload=function(){var c,s,a,v,g;for(v=[],c=0,s=(a=this.subscriptions).length;c<s;c++)g=a[c],v.push(this.sendCommand(g,"subscribe"));return v},p.prototype.notifyAll=function(){var c,s,a,v,g,f,h;for(s=arguments[0],c=2<=arguments.length?A.call(arguments,1):[],f=[],a=0,v=(g=this.subscriptions).length;a<v;a++)h=g[a],f.push(this.notify.apply(this,[h,s].concat(A.call(c))));return f},p.prototype.notify=function(){var c,s,a,v,g,f,h;for(f=arguments[0],s=arguments[1],c=3<=arguments.length?A.call(arguments,2):[],g=[],a=0,v=(h=typeof f=="string"?this.findAll(f):[f]).length;a<v;a++)f=h[a],g.push(typeof f[s]=="function"?f[s].apply(f,c):void 0);return g},p.prototype.sendCommand=function(c,s){var a;return a=c.identifier,this.consumer.send({command:s,identifier:a})},p}()}.call(this),function(){m.Subscription=function(){var A;function p(c,s,a){this.consumer=c,s==null&&(s={}),this.identifier=JSON.stringify(s),A(this,a)}return p.prototype.perform=function(c,s){return s==null&&(s={}),s.action=c,this.send(s)},p.prototype.send=function(c){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(c)})},p.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},A=function(c,s){var a,v;if(s!=null)for(a in s)v=s[a],c[a]=v;return c},p}()}.call(this),function(){m.Consumer=function(){function A(p){this.url=p,this.subscriptions=new m.Subscriptions(this),this.connection=new m.Connection(this)}return A.prototype.send=function(p){return this.connection.send(p)},A.prototype.connect=function(){return this.connection.open()},A.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},A.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},A}()}.call(this)}).call(this),C.exports?C.exports=m:(B=typeof($=m)=="function"?$.call(k,I,k,C):$)===void 0||(C.exports=B)}).call(this)}},X={};function F(C){var k=X[C];if(k!==void 0)return k.exports;var I=X[C]={exports:{}};return mt[C].call(I.exports,I,I.exports,F),I.exports}F.n=C=>{var k=C&&C.__esModule?()=>C.default:()=>C;return F.d(k,{a:k}),k},F.d=(C,k)=>{for(var I in k)F.o(k,I)&&!F.o(C,I)&&Object.defineProperty(C,I,{enumerable:!0,get:k[I]})},F.o=(C,k)=>Object.prototype.hasOwnProperty.call(C,k),F.r=C=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(C,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(C,"__esModule",{value:!0})};var it={};return(()=>{function C(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}F.r(it),F.d(it,{createCableCarRoute:()=>sn});var k=function(){function t(){var e,o;(function(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")})(this,t),o={},(e="consumers")in this?Object.defineProperty(this,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[e]=o}var n,r;return n=t,(r=[{key:"consumerFor",value:function(e){var o=e.webSocketURL||"default";if(!this.consumers[o]){var i=e.provider.createConsumer(e.webSocketURL);this.consumers[o]=i}return this.consumers[o]}},{key:"unsubscribeAll",value:function(){Object.values(this.consumers).forEach(function(e){var o,i;e==null||(o=e.subscriptions)===null||o===void 0||(i=o.subscriptions)===null||i===void 0||i.forEach(function(u){u==null||u.unsubscribe()})})}}])&&C(n.prototype,r),t}(),I=F(392),$=F.n(I);function B(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function m(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function A(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var p=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};B(this,t),A(this,"cars",[]),A(this,"provider",void 0),A(this,"webSocketURL",null),this.webSocketURL=e.webSocketURL||null,this.provider=e.provider||$()}var n,r;return n=t,(r=[{key:"addCar",value:function(e){this.cars.push(e)}},{key:"removeCar",value:function(e){var o=this.cars.indexOf(e);o>-1&&this.cars.splice(o,1)}}])&&m(n.prototype,r),t}();function c(t){for(var n=arguments.length,r=Array(n>1?n-1:0),e=1;e<n;e++)r[e-1]=arguments[e];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map(function(o){return"'"+o+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function s(t){return!!t&&!!t[j]}function a(t){return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var e=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return e===Object||typeof e=="function"&&Function.toString.call(e)===Xt}(t)||Array.isArray(t)||!!t[kt]||!!t.constructor[kt]||W(t)||U(t))}function v(t,n,r){r===void 0&&(r=!1),g(t)===0?(r?Object.keys:K)(t).forEach(function(e){r&&typeof e=="symbol"||n(e,t[e],t)}):t.forEach(function(e,o){return n(o,e,t)})}function g(t){var n=t[j];return n?n.i>3?n.i-4:n.i:Array.isArray(t)?1:W(t)?2:U(t)?3:0}function f(t,n){return g(t)===2?t.has(n):Object.prototype.hasOwnProperty.call(t,n)}function h(t,n,r){var e=g(t);e===2?t.set(n,r):e===3?(t.delete(n),t.add(r)):t[n]=r}function P(t,n){return t===n?t!==0||1/t==1/n:t!=t&&n!=n}function W(t){return Gt&&t instanceof Map}function U(t){return Vt&&t instanceof Set}function J(t){return t.o||t.t}function ct(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var n=Et(t);delete n[j];for(var r=K(n),e=0;e<r.length;e++){var o=r[e],i=n[o];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(n[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[o]})}return Object.create(Object.getPrototypeOf(t),n)}function ut(t,n){return n===void 0&&(n=!1),st(t)||s(t)||!a(t)||(g(t)>1&&(t.set=t.add=t.clear=t.delete=Ht),Object.freeze(t),n&&v(t,function(r,e){return ut(e,!0)},!0)),t}function Ht(){c(2)}function st(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function N(t){var n=gt[t];return n||c(18,t),n}function at(){return q}function lt(t,n){n&&(N("Patches"),t.u=[],t.s=[],t.v=n)}function Q(t){ft(t),t.p.forEach($t),t.p=null}function ft(t){t===q&&(q=t.l)}function wt(t){return q={p:[],l:q,h:t,m:!0,_:0}}function $t(t){var n=t[j];n.i===0||n.i===1?n.j():n.O=!0}function pt(t,n){n._=n.p.length;var r=n.p[0],e=t!==void 0&&t!==r;return n.h.g||N("ES5").S(n,t,e),e?(r[j].P&&(Q(n),c(4)),a(t)&&(t=Y(n,t),n.l||Z(n,t)),n.u&&N("Patches").M(r[j],t,n.u,n.s)):t=Y(n,r,[]),Q(n),n.u&&n.v(n.u,n.s),t!==Ct?t:void 0}function Y(t,n,r){if(st(n))return n;var e=n[j];if(!e)return v(n,function(i,u){return Ot(t,e,n,i,u,r)},!0),n;if(e.A!==t)return n;if(!e.P)return Z(t,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=e.i===4||e.i===5?e.o=ct(e.k):e.o;v(e.i===3?new Set(o):o,function(i,u){return Ot(t,e,o,i,u,r)}),Z(t,o,!1),r&&t.u&&N("Patches").R(e,r,t.u,t.s)}return e.o}function Ot(t,n,r,e,o,i){if(s(o)){var u=Y(t,o,i&&n&&n.i!==3&&!f(n.D,e)?i.concat(e):void 0);if(h(r,e,u),!s(u))return;t.m=!1}if(a(o)&&!st(o)){if(!t.h.F&&t._<1)return;Y(t,o),n&&n.A.l||Z(t,o)}}function Z(t,n,r){r===void 0&&(r=!1),t.h.F&&t.m&&ut(n,r)}function ht(t,n){var r=t[j];return(r?J(r):t)[n]}function St(t,n){if(n in t)for(var r=Object.getPrototypeOf(t);r;){var e=Object.getOwnPropertyDescriptor(r,n);if(e)return e;r=Object.getPrototypeOf(r)}}function z(t){t.P||(t.P=!0,t.l&&z(t.l))}function dt(t){t.o||(t.o=ct(t.t))}function vt(t,n,r){var e=W(n)?N("MapSet").N(n,r):U(n)?N("MapSet").T(n,r):t.g?function(o,i){var u=Array.isArray(o),l={i:u?1:0,A:i?i.A:at(),P:!1,I:!1,D:{},l:i,t:o,k:null,o:null,j:null,C:!1},d=l,y=H;u&&(d=[l],y=tt);var b=Proxy.revocable(d,y),O=b.revoke,w=b.proxy;return l.k=w,l.j=O,w}(n,r):N("ES5").J(n,r);return(r?r.A:at()).p.push(e),e}function qt(t){return s(t)||c(22,t),function n(r){if(!a(r))return r;var e,o=r[j],i=g(r);if(o){if(!o.P&&(o.i<4||!N("ES5").K(o)))return o.t;o.I=!0,e=Pt(r,i),o.I=!1}else e=Pt(r,i);return v(e,function(u,l){o&&function(d,y){return g(d)===2?d.get(y):d[y]}(o.t,u)===l||h(e,u,n(l))}),i===3?new Set(e):e}(t)}function Pt(t,n){switch(n){case 2:return new Map(t);case 3:return Array.from(t)}return ct(t)}var At,q,yt=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",Gt=typeof Map<"u",Vt=typeof Set<"u",jt=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Ct=yt?Symbol.for("immer-nothing"):((At={})["immer-nothing"]=!0,At),kt=yt?Symbol.for("immer-draftable"):"__$immer_draftable",j=yt?Symbol.for("immer-state"):"__$immer_state",Xt=""+Object.prototype.constructor,K=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,Et=Object.getOwnPropertyDescriptors||function(t){var n={};return K(t).forEach(function(r){n[r]=Object.getOwnPropertyDescriptor(t,r)}),n},gt={},H={get:function(t,n){if(n===j)return t;var r=J(t);if(!f(r,n))return function(o,i,u){var l,d=St(i,u);return d?"value"in d?d.value:(l=d.get)===null||l===void 0?void 0:l.call(o.k):void 0}(t,r,n);var e=r[n];return t.I||!a(e)?e:e===ht(t.t,n)?(dt(t),t.o[n]=vt(t.A.h,e,t)):e},has:function(t,n){return n in J(t)},ownKeys:function(t){return Reflect.ownKeys(J(t))},set:function(t,n,r){var e=St(J(t),n);if(e!=null&&e.set)return e.set.call(t.k,r),!0;if(!t.P){var o=ht(J(t),n),i=o==null?void 0:o[j];if(i&&i.t===r)return t.o[n]=r,t.D[n]=!1,!0;if(P(r,o)&&(r!==void 0||f(t.t,n)))return!0;dt(t),z(t)}return t.o[n]===r&&typeof r!="number"&&(r!==void 0||n in t.o)||(t.o[n]=r,t.D[n]=!0,!0)},deleteProperty:function(t,n){return ht(t.t,n)!==void 0||n in t.t?(t.D[n]=!1,dt(t),z(t)):delete t.D[n],t.o&&delete t.o[n],!0},getOwnPropertyDescriptor:function(t,n){var r=J(t),e=Reflect.getOwnPropertyDescriptor(r,n);return e&&{writable:!0,configurable:t.i!==1||n!=="length",enumerable:e.enumerable,value:r[n]}},defineProperty:function(){c(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){c(12)}},tt={};v(H,function(t,n){tt[t]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}}),tt.deleteProperty=function(t,n){return H.deleteProperty.call(this,t[0],n)},tt.set=function(t,n,r){return H.set.call(this,t[0],n,r,t[0])};var Bt=function(){function t(r){var e=this;this.g=jt,this.F=!0,this.produce=function(o,i,u){if(typeof o=="function"&&typeof i!="function"){var l=i;i=o;var d=e;return function(S){var R=this;S===void 0&&(S=l);for(var _=arguments.length,D=Array(_>1?_-1:0),M=1;M<_;M++)D[M-1]=arguments[M];return d.produce(S,function(L){var E;return(E=i).call.apply(E,[R,L].concat(D))})}}var y;if(typeof i!="function"&&c(6),u!==void 0&&typeof u!="function"&&c(7),a(o)){var b=wt(e),O=vt(e,o,void 0),w=!0;try{y=i(O),w=!1}finally{w?Q(b):ft(b)}return typeof Promise<"u"&&y instanceof Promise?y.then(function(S){return lt(b,u),pt(S,b)},function(S){throw Q(b),S}):(lt(b,u),pt(y,b))}if(!o||typeof o!="object")return(y=i(o))===Ct?void 0:(y===void 0&&(y=o),e.F&&ut(y,!0),y);c(21,o)},this.produceWithPatches=function(o,i){return typeof o=="function"?function(d){for(var y=arguments.length,b=Array(y>1?y-1:0),O=1;O<y;O++)b[O-1]=arguments[O];return e.produceWithPatches(d,function(w){return o.apply(void 0,[w].concat(b))})}:[e.produce(o,i,function(d,y){u=d,l=y}),u,l];var u,l},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var n=t.prototype;return n.createDraft=function(r){a(r)||c(8),s(r)&&(r=qt(r));var e=wt(this),o=vt(this,r,void 0);return o[j].C=!0,ft(e),o},n.finishDraft=function(r,e){var o=(r&&r[j]).A;return lt(o,e),pt(void 0,o)},n.setAutoFreeze=function(r){this.F=r},n.setUseProxies=function(r){r&&!jt&&c(20),this.g=r},n.applyPatches=function(r,e){var o;for(o=e.length-1;o>=0;o--){var i=e[o];if(i.path.length===0&&i.op==="replace"){r=i.value;break}}var u=N("Patches").$;return s(r)?u(r,e):this.produce(r,function(l){return u(l,e.slice(o+1))})},t}(),T=new Bt;function Qt(t,n){return t===n}function Yt(t,n,r){if(n===null||r===null||n.length!==r.length)return!1;for(var e=n.length,o=0;o<e;o++)if(!t(n[o],r[o]))return!1;return!0}T.produce,T.produceWithPatches.bind(T),T.setAutoFreeze.bind(T),T.setUseProxies.bind(T),T.applyPatches.bind(T),T.createDraft.bind(T),T.finishDraft.bind(T),function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),e=1;e<n;e++)r[e-1]=arguments[e]}(function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qt,r=null,e=null;return function(){return Yt(n,r,arguments)||(e=t.apply(null,arguments)),r=arguments,e}});var _t=function(){return Math.random().toString(36).substring(7).split("").join(".")};function Rt(t){return function(n){var r=n.dispatch,e=n.getState;return function(o){return function(i){return typeof i=="function"?i(r,e,t):o(i)}}}}_t(),_t(),Rt().withExtraArgument=Rt;var nt,Zt=(nt=function(t,n){return nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])},nt(t,n)},function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}nt(t,n),t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}),Dt=function(t,n){for(var r=0,e=n.length,o=t.length;r<e;r++,o++)t[o]=n[r];return t},tn=Object.defineProperty,xt=Object.getOwnPropertySymbols,nn=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable,It=function(t,n,r){return n in t?tn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r},Tt=function(t,n){for(var r in n||(n={}))nn.call(n,r)&&It(t,r,n[r]);if(xt)for(var e=0,o=xt(n);e<o.length;e++)r=o[e],en.call(n,r)&&It(t,r,n[r]);return t};(function(t){function n(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var o=t.apply(this,r)||this;return Object.setPrototypeOf(o,n.prototype),o}Zt(n,t),Object.defineProperty(n,Symbol.species,{get:function(){return n},enumerable:!1,configurable:!0}),n.prototype.concat=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return t.prototype.concat.apply(this,r)},n.prototype.prepend=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return r.length===1&&Array.isArray(r[0])?new(n.bind.apply(n,Dt([void 0],r[0].concat(this)))):new(n.bind.apply(n,Dt([void 0],r.concat(this))))}})(Array),function(){function t(i,u){var l=o[i];return l?l.enumerable=u:o[i]=l={configurable:!0,enumerable:u,get:function(){var d=this[j];return H.get(d,i)},set:function(d){var y=this[j];H.set(y,i,d)}},l}function n(i){for(var u=i.length-1;u>=0;u--){var l=i[u][j];if(!l.P)switch(l.i){case 5:e(l)&&z(l);break;case 4:r(l)&&z(l)}}}function r(i){for(var u=i.t,l=i.k,d=K(l),y=d.length-1;y>=0;y--){var b=d[y];if(b!==j){var O=u[b];if(O===void 0&&!f(u,b))return!0;var w=l[b],S=w&&w[j];if(S?S.t!==O:!P(w,O))return!0}}var R=!!u[j];return d.length!==K(u).length+(R?0:1)}function e(i){var u=i.k;if(u.length!==i.t.length)return!0;var l=Object.getOwnPropertyDescriptor(u,u.length-1);return!(!l||l.get)}var o={};(function(i,u){gt[i]||(gt[i]=u)})("ES5",{J:function(i,u){var l=Array.isArray(i),d=function(b,O){if(b){for(var w=Array(O.length),S=0;S<O.length;S++)Object.defineProperty(w,""+S,t(S,!0));return w}var R=Et(O);delete R[j];for(var _=K(R),D=0;D<_.length;D++){var M=_[D];R[M]=t(M,b||!!R[M].enumerable)}return Object.create(Object.getPrototypeOf(O),R)}(l,i),y={i:l?5:4,A:u?u.A:at(),P:!1,I:!1,D:{},l:u,t:i,k:d,o:null,O:!1,C:!1};return Object.defineProperty(d,j,{value:y,writable:!0}),d},S:function(i,u,l){l?s(u)&&u[j].A===i&&n(i.p):(i.u&&function d(y){if(y&&typeof y=="object"){var b=y[j];if(b){var O=b.t,w=b.k,S=b.D,R=b.i;if(R===4)v(w,function(E){E!==j&&(O[E]!==void 0||f(O,E)?S[E]||d(w[E]):(S[E]=!0,z(b)))}),v(O,function(E){w[E]!==void 0||f(w,E)||(S[E]=!1,z(b))});else if(R===5){if(e(b)&&(z(b),S.length=!0),w.length<O.length)for(var _=w.length;_<O.length;_++)S[_]=!1;else for(var D=O.length;D<w.length;D++)S[D]=!0;for(var M=Math.min(w.length,O.length),L=0;L<M;L++)S[L]===void 0&&d(w[L])}}}}(i.p[0]),n(i.p))},K:function(i){return i.i===4?r(i):e(i)}})}();var Mt=function(t,n){return String(t).slice(0,n.length)===n},Ft=function(t){if(typeof t=="string")return function(n){return Mt(String(n.type),t)};if(Array.isArray(t))return function(n){return t.some(function(r){return typeof r=="string"?Mt(String(n.type),r):r instanceof RegExp?String(n.type).match(r)!=null:void 0})};if(t instanceof RegExp)return function(n){return String(n.type).match(t)!=null};if(typeof t=="function")return function(n){return t(n)};throw new TypeError("CableCar: 'permittedActions' option is not formatted correctly (string|string[]|RegExp|function)")},rn=["type","meta","payload"];function Wt(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,e)}return r}function G(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Wt(Object(r),!0).forEach(function(e){x(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wt(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function on(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function x(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var Nt="__cablecar__",Lt="channel",V="redux-cablecar",cn=function(){function t(e,o,i,u,l){(function(d,y){if(!(d instanceof y))throw new TypeError("Cannot call a class as a function")})(this,t),x(this,"consumer",void 0),x(this,"store",void 0),x(this,"channel",void 0),x(this,"active",!1),x(this,"connected",!1),x(this,"subscription",void 0),x(this,"_options",{}),x(this,"_permittedActionFn",function(){return!0}),x(this,"_destroyCallback",void 0),this.consumer=e,this.store=o,this.channel=String(i),this.options=u||{},this.subscription=this.init(),this._destroyCallback=l}var n,r;return n=t,(r=[{key:"options",get:function(){return this._options},set:function(e){e.permittedActions!==void 0?this._permittedActionFn=Ft(e.permittedActions):this._permittedActionFn=Ft("RAILS");var o={params:e.params||{},silent:!!e.silent,matchChannel:!!e.matchChannel};e.initialized&&(o.initialized=e.initialized),e.connected&&(o.connected=e.connected),e.disconnected&&(o.disconnected=e.disconnected),e.received&&(o.received=e.received),e.rejected&&(o.rejected=e.rejected),this._options=Object.freeze(o)}},{key:"destroy",value:function(){var e;this.active=!1,this.connected=!1,(e=this.subscription)===null||e===void 0||e.unsubscribe(),this.subscription=null,this._destroyCallback&&(this._destroyCallback(),this._destroyCallback=void 0)}},{key:"perform",value:function(e,o){this.isReady(),this.subscription.perform(e,o)}},{key:"send",value:function(e){this.isReady(),this.subscription.send(e)}},{key:"pause",value:function(){this.active=!1}},{key:"resume",value:function(){this.active=!0}},{key:"permitsAction",value:function(e){var o=!(e.meta&&e.meta.__cablecar__);return!(this.options.matchChannel&&o&&e.meta&&e.meta.channel&&e.meta.channel!=this.channel)&&(o&&(o=this._permittedActionFn(e)),o)}},{key:"init",value:function(){var e=this,o=function(u){e.store&&!e.options.silent&&e.store.dispatch(u)},i=function(u){return function(l,d){function y(){for(var b=[],O=0;O<arguments.length;O++)b[O]=arguments[O];if(d){var w=d.apply(void 0,b);if(!w)throw new Error("prepareAction did not return an object");return Tt(Tt({type:l,payload:w.payload},"meta"in w&&{meta:w.meta}),"error"in w&&{error:w.error})}return{type:l,payload:b[0]}}return y.toString=function(){return""+l},y.type=l,y.match=function(b){return b.type===l},y}(u,function(){var l;return{payload:{},meta:(l={},x(l,Nt,!0),x(l,Lt,e.channel),l)}})()};return this.consumer.subscriptions.create(G({channel:this.channel},this.options.params),{initialized:function(){e.active=!0,o(i("".concat(V,"/INIT"))),e.options.initialized&&e.options.initialized()},connected:function(){e.connected=!0,o(i("".concat(V,"/CONNECTED"))),e.options.connected&&e.options.connected()},disconnected:function(){e.connected=!1,o(i("".concat(V,"/DISCONNECTED"))),e.options.disconnected&&e.options.disconnected()},received:function(u){var l,d=u.type,y=u.meta,b=u.payload,O=function(S,R){if(S==null)return{};var _,D,M=function(E,an){if(E==null)return{};var et,rt,Jt={},Kt=Object.keys(E);for(rt=0;rt<Kt.length;rt++)et=Kt[rt],an.indexOf(et)>=0||(Jt[et]=E[et]);return Jt}(S,R);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(S);for(D=0;D<L.length;D++)_=L[D],R.indexOf(_)>=0||Object.prototype.propertyIsEnumerable.call(S,_)&&(M[_]=S[_])}return M}(u,rn),w={payload:G(G({},b),O),meta:G(G({},y),{},(l={},x(l,Nt,!0),x(l,Lt,e.channel),l)),type:d||"".concat(V,"/RECEIVED")};o(w)},rejected:function(u){e.active=!1,e.connected=!1,o(i("".concat(V,"/REJECTED"))),e.options.rejected?e.options.rejected():console.error("CableCar: connection rejected. (Channel: ".concat(e.channel,") ").concat(u))}})}},{key:"isReady",value:function(){if(!this.connected)throw new TypeError("CableCar channel: ".concat(this.channel," is disconnected."));if(!this.active)throw new TypeError("CableCar channel: ".concat(this.channel," is paused."))}}])&&on(n.prototype,r),t}();function un(t){return function(n){return function(r){return function(e){var o=t.cars.filter(function(u){return u.active&&u.permitsAction(e)}),i=!1;return o.length&&(i=o.reduce(function(u,l){var d=e.meta;return l.connected?(l.send(e),u&&d!=null&&d.isOptimistic&&(u=!1)):((d!=null&&d.isOptimistic||d!=null&&d.isOptimisticOnFail)&&(u=!1),console.error("CableCar channel: ".concat(l.channel," Dropped action.")+(u?"":" Action passed thru middleware to Redux (optimistic)."),e)),u},!0)),i?n.getState():r(e)}}}}var zt=new k;function sn(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=new p(t),r=zt.consumerFor(n);return{createMiddleware:function(){return un(n)},connect:function(e,o,i){var u=new cn(r,e,o,i||{},function(){n.removeCar(u)});return n.addCar(u),Ut(u)},allCars:function(){return n.cars.map(Ut)},reset:function(){n.cars=[]}}}function Ut(t){return{destroy:function(){return t.destroy()},pause:function(){return t.pause()},resume:function(){return t.resume()},perform:function(n,r){return t.perform(n,r)},send:function(n){return t.send(n)}}}typeof window<"u"&&window.addEventListener("beforeunload",function(){zt.unsubscribeAll()})})(),it})()})})(pn);const hn=bt.createCableCarRoute({webSocketURL:fn.cableUrl});hn.createMiddleware();
//# sourceMappingURL=cable.b439d62f.js.map
